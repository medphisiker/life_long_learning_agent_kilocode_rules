# NetRunner Protocol (v3.2)

> **PROJECT SPECIFIC**: Протокол взаимодействия между Агентом, UI и Планировщиком.

## Основные принципы

1.  **CLI-Priority**: Слэш-команды (`/finish_quizz`, `/skip_question`) обрабатываются в `planner_node` **до** вызова LLM. Это гарантирует мгновенную реакцию на команды управления.
2.  **Quiz Context Preservation**: При RAG-уточнениях во время квиза, система обязана возвращать пользователя к вопросу, добавляя маркер `[SYSTEM: QUIZ_CONTEXT_RESUMED]`.

## Режимы взаимодействия (`interaction_mode`)

| Режим | Описание | Интент |
| :--- | :--- | :--- |
| `AI_SYNC` | Стандартный диалог или RAG. | Определяется LLM |
| `ANSWER_QUIZ` | Режим ответа на вопрос теста. | Принудительно `quiz_answering` |

## Типы сообщений

*   `quizz_question`: Специальный тип сообщения для отделения вопросов теста от обычной болтовни. Позволяет UI рендерить их иначе.

## Логика Планировщика (Planner Logic)

В режиме активного квиза:
*   Короткие сообщения без `?` принудительно классифицируются как `quiz_answering`.
*   Даже если LLM классифицировала как `general` или `rag_answer`, планировщик может переопределить это на основе контекста.