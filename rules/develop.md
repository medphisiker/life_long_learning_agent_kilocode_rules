# Правила разработки (Development Rules)

Данный документ определяет стандарты и подходы к разработке, отладке и тестированию в проекте.

## 1. Принципы работы с кодом
- **Объективность**: Не предполагай поведение системы, если оно не описано.
- **Верификация**: Всегда проверяй текущую реализацию через `codebase_search` перед внесением изменений.
- **Актуальность**: Сверяйся с документацией библиотек через `context7` (особенно при возникновении ошибок).
- **Исследование**: Используй `tavily` для поиска решений в интернете, если проблема выходит за рамки текущей кодовой базы.

## 2. Тестирование
- **Интеграционные тесты**: Должны запускаться внутри соответствующих Docker-контейнеров.
- **Сценарии NetRunner**: При обновлении графа агента всегда запускай `web_ui_service/tests/test_netrunner_scenarios.py`.
- **WebSocket события**: При тестировании асинхронных взаимодействий проверяй последовательность событий (steps/tools) через WebSocket, а не только финальный текстовый ответ.

## 3. NetRunner Protocol (v3.0)
При разработке узлов графа `AgentSystem` соблюдай следующие правила:
- **CLI-команды**: Слэш-команды (`/finish_quizz`, `/skip_question`) имеют приоритет и должны обрабатываться в `planner_node` до вызова LLM.
- **Контекст квиза**: При ответе на уточняющие вопросы (RAG) в процессе квиза, необходимо возвращать пользователя к текущему вопросу, используя маркер `[SYSTEM: QUIZ_CONTEXT_RESUMED]`.
- **Интенты**: Поддерживай новые типы интентов (`skip_question`, `evaluate_quiz`) в `IntentModel` и промптах.

## 4. Документирование
- Любые изменения в логике графа должны быть отражены в `agent_service/docs/agent_documentation.md` (включая Mermaid диаграммы).
- Новые идеи по UI/UX фиксируются в `docs/ideas/`.